<!--#include file="writable/asp/colors-sd.asp"-->
<!--#include file="writable/asp/sizes-sd.asp"-->
<!--#include file="writable/asp/state-sd.asp"-->
<!--#include file="writable/asp/subcatwd-sd.asp"-->
<!--#include file="writable/asp/subcatmfg-sd.asp"-->
<!--#include file="writable/asp/vendors-sd.asp"-->
<!--#include file="writable/asp/webnavtype-sd.asp"-->
<!--#include file="writable/asp/webnavtypeid-sd.asp"-->
<!--#include file="writable/asp/webtypes-sd.asp"-->
<!--#include file="writable/asp/webtypesaz-sd.asp"-->
<!--#include file="writable/asp/webnotes-sd.asp"-->
<!--#include file="writable/asp/zones-sd.asp"-->
<!--#include file="writable/asp/discounttax-sd.asp"-->
<%

' --- Set these to the database values found in the shipping method table
vFreeShippingMethodID = 11
vFreeShippingMethod = "FEDEX Ground-US Mail"

' --- IISCart2000 Encryption key
vEncryptKey = "2002-WTC-HemLock-2003"

' --- Function to clean up strings for use in db
FUNCTION CS (s, endchar)
	pos = InStr(s, "'")
	While pos > 0
		s = Mid(s, 1, pos) & "'" & Mid(s, pos + 1)
		pos = InStr(pos + 2, s, "'")
	Wend
 CS="'" & s & "'" & endchar
END FUNCTION

' --- What state are we in?
Dim vThisState
vThisState = "NY"

' --- We need this for display purposes just about everywhere during the checkout process
Dim States
Set States = Server.CreateObject("Scripting.Dictionary")
States.Item("AP") = "APO/FPO"
States.Item("AL") = "Alabama"
States.Item("AK") = "Alaska"
States.Item("AR") = "Arkansas"
States.Item("AZ") = "Arizona"
States.Item("CA") = "California"
States.Item("CO") = "Colorado"
States.Item("CT") = "Connecticut"
States.Item("DE") = "Delaware"
States.Item("DC") = "District of Columbia"
States.Item("FL") = "Florida"
States.Item("GA") = "Georgia"
States.Item("HI") = "Hawaii"
States.Item("ID") = "Idaho"
States.Item("IL") = "Illinois"
States.Item("IN") = "Indiana"
States.Item("IA") = "Iowa"
States.Item("KS") = "Kansas"
States.Item("KY") = "Kentucky"
States.Item("LA") = "Louisiana"
States.Item("ME") = "Maine"
States.Item("MD") = "Maryland"
States.Item("MA") = "Massachusetts"
States.Item("MI") = "Michigan"
States.Item("MN") = "Minnesota"
States.Item("MS") = "Mississippi"
States.Item("MO") = "Missouri"
States.Item("MT") = "Montana"
States.Item("NE") = "Nebraska"
States.Item("NV") = "Nevada"
States.Item("NH") = "New Hampshire"
States.Item("NJ") = "New Jersey"
States.Item("NM") = "New Mexico"
States.Item("NY") = "New York"
States.Item("NC") = "North Carolina"
States.Item("ND") = "North Dakota"
States.Item("OH") = "Ohio"
States.Item("OK") = "Oklahoma"
States.Item("OR") = "Oregon"
States.Item("PA") = "Pennsylvania"
States.Item("PR") = "Puerto Rico"
States.Item("RI") = "Rhode Island"
States.Item("SC") = "South Carolina"
States.Item("SD") = "South Dakota"
States.Item("TN") = "Tennessee"
States.Item("TX") = "Texas"
States.Item("UT") = "Utah"
States.Item("VT") = "Vermont"
States.Item("VA") = "Virginia"
States.Item("WA") = "Washington"
States.Item("WV") = "West Virginia"
States.Item("WI") = "Wisconsin"
States.Item("WY") = "Wyoming"
States.Item("AB") = "ALberta"
States.Item("BC") = "British Columbia"
States.Item("MB") = "Manitoba"
States.Item("NB") = "New Brunswick"
States.Item("NL") = "Newfoundland and Labrador"
States.Item("NT") = "Northwest Territories"
States.Item("NS") = "Nova Scotia"
States.Item("NU") = "Nunavut"
States.Item("ON") = "Ontario"
States.Item("PE") = "Prince Edward Island"
States.Item("QC") = "Quebec"
States.Item("SK") = "Saskatchewan"
States.Item("YT") = "Yukon"


vCountry = Application("Country")
vCountryCount = Application("CountryCount")

' country codes -//jonroig.com/freecode/countryCodeTool.php
Dim vCountryCodes
Set vCountryCodes = Server.CreateObject("Scripting.Dictionary")
vCountryCodes.Item("AF") = "Afghanistan"
vCountryCodes.Item("AL") = "Albania"
vCountryCodes.Item("DZ") = "Algeria"
vCountryCodes.Item("AS") = "American Samoa"
vCountryCodes.Item("AD") = "Andorra"
vCountryCodes.Item("AO") = "Angola"
vCountryCodes.Item("AI") = "Anguilla"
vCountryCodes.Item("AQ") = "Antarctica"
vCountryCodes.Item("AG") = "Antigua And Barbuda"
vCountryCodes.Item("AR") = "Argentina"
vCountryCodes.Item("AM") = "Armenia"
vCountryCodes.Item("AW") = "Aruba"
vCountryCodes.Item("AU") = "Australia"
vCountryCodes.Item("AT") = "Austria"
vCountryCodes.Item("AZ") = "Azerbaijan"
vCountryCodes.Item("BS") = "Bahamas"
vCountryCodes.Item("BH") = "Bahrain"
vCountryCodes.Item("BD") = "Bangladesh"
vCountryCodes.Item("BB") = "Barbados"
vCountryCodes.Item("BY") = "Belarus"
vCountryCodes.Item("BE") = "Belgium"
vCountryCodes.Item("BZ") = "Belize"
vCountryCodes.Item("BJ") = "Benin"
vCountryCodes.Item("BM") = "Bermuda"
vCountryCodes.Item("BT") = "Bhutan"
vCountryCodes.Item("BO") = "Bolivia"
vCountryCodes.Item("BA") = "Bosnia And Herzegovina"
vCountryCodes.Item("BW") = "Botswana"
vCountryCodes.Item("BV") = "Bouvet Island"
vCountryCodes.Item("BR") = "Brazil"
vCountryCodes.Item("IO") = "British Indian Ocean Territory"
vCountryCodes.Item("BN") = "Brunei Darussalam"
vCountryCodes.Item("BG") = "Bulgaria"
vCountryCodes.Item("BF") = "Burkina Faso"
vCountryCodes.Item("BI") = "Burundi"
vCountryCodes.Item("KH") = "Cambodia"
vCountryCodes.Item("CM") = "Cameroon"
vCountryCodes.Item("CA") = "Canada"
vCountryCodes.Item("CV") = "Cape Verde"
vCountryCodes.Item("KY") = "Cayman Islands"
vCountryCodes.Item("CF") = "Central African Republic"
vCountryCodes.Item("TD") = "Chad"
vCountryCodes.Item("CL") = "Chile"
vCountryCodes.Item("CN") = "China"
vCountryCodes.Item("CX") = "Christmas Island"
vCountryCodes.Item("CC") = "Cocos (keeling) Islands"
vCountryCodes.Item("CO") = "Colombia"
vCountryCodes.Item("KM") = "Comoros"
vCountryCodes.Item("CG") = "Congo"
vCountryCodes.Item("CD") = "Congo, The Democratic Republic Of The"
vCountryCodes.Item("CK") = "Cook Islands"
vCountryCodes.Item("CR") = "Costa Rica"
vCountryCodes.Item("CI") = "Cote D'ivoire"
vCountryCodes.Item("HR") = "Croatia"
vCountryCodes.Item("CU") = "Cuba"
vCountryCodes.Item("CY") = "Cyprus"
vCountryCodes.Item("CZ") = "Czech Republic"
vCountryCodes.Item("DK") = "Denmark"
vCountryCodes.Item("DJ") = "Djibouti"
vCountryCodes.Item("DM") = "Dominica"
vCountryCodes.Item("DO") = "Dominican Republic"
vCountryCodes.Item("TP") = "East Timor"
vCountryCodes.Item("EC") = "Ecuador"
vCountryCodes.Item("EG") = "Egypt"
vCountryCodes.Item("SV") = "El Salvador"
vCountryCodes.Item("GQ") = "Equatorial Guinea"
vCountryCodes.Item("ER") = "Eritrea"
vCountryCodes.Item("EE") = "Estonia"
vCountryCodes.Item("ET") = "Ethiopia"
vCountryCodes.Item("FK") = "Falkland Islands (malvinas)"
vCountryCodes.Item("FO") = "Faroe Islands"
vCountryCodes.Item("FJ") = "Fiji"
vCountryCodes.Item("FI") = "Finland"
vCountryCodes.Item("FR") = "France"
vCountryCodes.Item("GF") = "French Guiana"
vCountryCodes.Item("PF") = "French Polynesia"
vCountryCodes.Item("TF") = "French Southern Territories"
vCountryCodes.Item("GA") = "Gabon"
vCountryCodes.Item("GM") = "Gambia"
vCountryCodes.Item("GE") = "Georgia"
vCountryCodes.Item("DE") = "Germany"
vCountryCodes.Item("GH") = "Ghana"
vCountryCodes.Item("GI") = "Gibraltar"
vCountryCodes.Item("GR") = "Greece"
vCountryCodes.Item("GL") = "Greenland"
vCountryCodes.Item("GD") = "Grenada"
vCountryCodes.Item("GP") = "Guadeloupe"
vCountryCodes.Item("GU") = "Guam"
vCountryCodes.Item("GT") = "Guatemala"
vCountryCodes.Item("GN") = "Guinea"
vCountryCodes.Item("GW") = "Guinea-bissau"
vCountryCodes.Item("GY") = "Guyana"
vCountryCodes.Item("HT") = "Haiti"
vCountryCodes.Item("HM") = "Heard Island And Mcdonald Islands"
vCountryCodes.Item("VA") = "Holy See (vatican City State)"
vCountryCodes.Item("HN") = "Honduras"
vCountryCodes.Item("HK") = "Hong Kong"
vCountryCodes.Item("HU") = "Hungary"
vCountryCodes.Item("IS") = "Iceland"
vCountryCodes.Item("IN") = "India"
vCountryCodes.Item("ID") = "Indonesia"
vCountryCodes.Item("IR") = "Iran, Islamic Republic Of"
vCountryCodes.Item("IQ") = "Iraq"
vCountryCodes.Item("IE") = "Ireland"
vCountryCodes.Item("IL") = "Israel"
vCountryCodes.Item("IT") = "Italy"
vCountryCodes.Item("JM") = "Jamaica"
vCountryCodes.Item("JP") = "Japan"
vCountryCodes.Item("JO") = "Jordan"
vCountryCodes.Item("KZ") = "Kazakstan"
vCountryCodes.Item("KE") = "Kenya"
vCountryCodes.Item("KI") = "Kiribati"
vCountryCodes.Item("KP") = "Korea, Democratic People's Republic Of"
vCountryCodes.Item("KR") = "Korea, Republic Of"
vCountryCodes.Item("KW") = "Kuwait"
vCountryCodes.Item("KG") = "Kyrgyzstan"
vCountryCodes.Item("LA") = "Lao People's Democratic Republic"
vCountryCodes.Item("LV") = "Latvia"
vCountryCodes.Item("LB") = "Lebanon"
vCountryCodes.Item("LS") = "Lesotho"
vCountryCodes.Item("LR") = "Liberia"
vCountryCodes.Item("LY") = "Libyan Arab Jamahiriya"
vCountryCodes.Item("LI") = "Liechtenstein"
vCountryCodes.Item("LT") = "Lithuania"
vCountryCodes.Item("LU") = "Luxembourg"
vCountryCodes.Item("MO") = "Macau"
vCountryCodes.Item("MK") = "Macedonia, The Former Yugoslav Republic Of"
vCountryCodes.Item("MG") = "Madagascar"
vCountryCodes.Item("MW") = "Malawi"
vCountryCodes.Item("MY") = "Malaysia"
vCountryCodes.Item("MV") = "Maldives"
vCountryCodes.Item("ML") = "Mali"
vCountryCodes.Item("MT") = "Malta"
vCountryCodes.Item("MH") = "Marshall Islands"
vCountryCodes.Item("MQ") = "Martinique"
vCountryCodes.Item("MR") = "Mauritania"
vCountryCodes.Item("MU") = "Mauritius"
vCountryCodes.Item("YT") = "Mayotte"
vCountryCodes.Item("MX") = "Mexico"
vCountryCodes.Item("FM") = "Micronesia, Federated States Of"
vCountryCodes.Item("MD") = "Moldova, Republic Of"
vCountryCodes.Item("MC") = "Monaco"
vCountryCodes.Item("MN") = "Mongolia"
vCountryCodes.Item("MS") = "Montserrat"
vCountryCodes.Item("MA") = "Morocco"
vCountryCodes.Item("MZ") = "Mozambique"
vCountryCodes.Item("MM") = "Myanmar"
vCountryCodes.Item("NA") = "Namibia"
vCountryCodes.Item("NR") = "Nauru"
vCountryCodes.Item("NP") = "Nepal"
vCountryCodes.Item("NL") = "Netherlands"
vCountryCodes.Item("AN") = "Netherlands Antilles"
vCountryCodes.Item("NC") = "New Caledonia"
vCountryCodes.Item("NZ") = "New Zealand"
vCountryCodes.Item("NI") = "Nicaragua"
vCountryCodes.Item("NE") = "Niger"
vCountryCodes.Item("NG") = "Nigeria"
vCountryCodes.Item("NU") = "Niue"
vCountryCodes.Item("NF") = "Norfolk Island"
vCountryCodes.Item("MP") = "Northern Mariana Islands"
vCountryCodes.Item("NO") = "Norway"
vCountryCodes.Item("OM") = "Oman"
vCountryCodes.Item("PK") = "Pakistan"
vCountryCodes.Item("PW") = "Palau"
vCountryCodes.Item("PA") = "Panama"
vCountryCodes.Item("PG") = "Papua New Guinea"
vCountryCodes.Item("PY") = "Paraguay"
vCountryCodes.Item("PE") = "Peru"
vCountryCodes.Item("PH") = "Philippines"
vCountryCodes.Item("PN") = "Pitcairn"
vCountryCodes.Item("PL") = "Poland"
vCountryCodes.Item("PT") = "Portugal"
vCountryCodes.Item("PR") = "Puerto Rico"
vCountryCodes.Item("QA") = "Qatar"
vCountryCodes.Item("RE") = "Reunion"
vCountryCodes.Item("RO") = "Romania"
vCountryCodes.Item("RU") = "Russian Federation"
vCountryCodes.Item("RW") = "Rwanda"
vCountryCodes.Item("SH") = "Saint Helena"
vCountryCodes.Item("KN") = "Saint Kitts And Nevis"
vCountryCodes.Item("LC") = "Saint Lucia"
vCountryCodes.Item("PM") = "Saint Pierre And Miquelon"
vCountryCodes.Item("VC") = "Saint Vincent And The Grenadines"
vCountryCodes.Item("WS") = "Samoa"
vCountryCodes.Item("SM") = "San Marino"
vCountryCodes.Item("ST") = "Sao Tome And Principe"
vCountryCodes.Item("SA") = "Saudi Arabia"
vCountryCodes.Item("SN") = "Senegal"
vCountryCodes.Item("SC") = "Seychelles"
vCountryCodes.Item("SL") = "Sierra Leone"
vCountryCodes.Item("SG") = "Singapore"
vCountryCodes.Item("SK") = "Slovakia"
vCountryCodes.Item("SI") = "Slovenia"
vCountryCodes.Item("SB") = "Solomon Islands"
vCountryCodes.Item("SO") = "Somalia"
vCountryCodes.Item("ZA") = "South Africa"
vCountryCodes.Item("GS") = "South Georgia And The South Sandwich Islands"
vCountryCodes.Item("ES") = "Spain"
vCountryCodes.Item("LK") = "Sri Lanka"
vCountryCodes.Item("SD") = "Sudan"
vCountryCodes.Item("SR") = "Suriname"
vCountryCodes.Item("SJ") = "Svalbard And Jan Mayen"
vCountryCodes.Item("SZ") = "Swaziland"
vCountryCodes.Item("SE") = "Sweden"
vCountryCodes.Item("CH") = "Switzerland"
vCountryCodes.Item("SY") = "Syrian Arab Republic"
vCountryCodes.Item("TW") = "Taiwan, Province Of China"
vCountryCodes.Item("TJ") = "Tajikistan"
vCountryCodes.Item("TZ") = "Tanzania, United Republic Of"
vCountryCodes.Item("TH") = "Thailand"
vCountryCodes.Item("TG") = "Togo"
vCountryCodes.Item("TK") = "Tokelau"
vCountryCodes.Item("TO") = "Tonga"
vCountryCodes.Item("TT") = "Trinidad And Tobago"
vCountryCodes.Item("TN") = "Tunisia"
vCountryCodes.Item("TR") = "Turkey"
vCountryCodes.Item("TM") = "Turkmenistan"
vCountryCodes.Item("TC") = "Turks And Caicos Islands"
vCountryCodes.Item("TV") = "Tuvalu"
vCountryCodes.Item("UG") = "Uganda"
vCountryCodes.Item("UA") = "Ukraine"
vCountryCodes.Item("AE") = "United Arab Emirates"
vCountryCodes.Item("GB") = "United Kingdom"
vCountryCodes.Item("US") = "United States"
vCountryCodes.Item("UM") = "United States Minor Outlying Islands"
vCountryCodes.Item("UY") = "Uruguay-TEST"
vCountryCodes.Item("UZ") = "Uzbekistan"
vCountryCodes.Item("VU") = "Vanuatu"
vCountryCodes.Item("VE") = "Venezuela"
vCountryCodes.Item("VN") = "Viet Nam"
vCountryCodes.Item("VG") = "Virgin Islands, British"
vCountryCodes.Item("VI") = "Virgin Islands, U.s."
vCountryCodes.Item("WF") = "Wallis And Futuna"
vCountryCodes.Item("EH") = "Western Sahara"
vCountryCodes.Item("YE") = "Yemen"
vCountryCodes.Item("YU") = "Yugoslavia"
vCountryCodes.Item("ZM") = "Zambia"
vCountryCodes.Item("ZW") = "Zimbabwe"

' We need this variable so we can define a proper reference
' to the secure (httpS) vs. non-secure (http) URL's.
' Right now, only used in displaycart.asp on the checkout button
vThisServer = Request.ServerVariables("SERVER_NAME")
vThisPort = Request.ServerVariables("SERVER_PORT")

' Define where the order files are saved
vSaveOrderPath = "D:\JohnR\"
'vSaveOrderPath = "D:\PUBLIC\HTML\www.bicyclebuys.com\JohnR\"

' debuggin referral data
if vRemote_IP = "69.127.248.96"  Then response.write "<hr>Referred by: " & Session("ReferredBy")                                                                                                                                                                                                                                                                                                                                               
%>